{% extends "base.html" %}
{% load static %}

{% block title %}Сообщить о проблеме{% endblock %}

{% block pageTitle %}
    Сообщить о проблеме
{% endblock %}

{% block content %}
<style>
h1{
    margin: 0;
}
</style>

{% if not user.is_authenticated %}
<h2><a href="{% url 'users:login' %}">Для того, чтобы продолжить авторизуйтесь </a></h2>

{% else %}
<div class="steps">
    <a href=" {% url 'reports:step1' %}"><div class="step" >
        <span class="circle">1</span>
        <h2>Укажите адрес</h2>
    </div></a>
     <a href=" {% url 'reports:step2' %}"><div class="step" >
        <span class="circle" style="background:#fff;">2</span>
        <h2>Укажите категорию проблемы</h2>
    </div></a>
     <a href=" {% url 'reports:step3' %}"><div class="step">
        <span class="circle">3</span>
        <h2>Опишите проблему</h2>
    </div></a>
</div>


<div class="step2-container">
    <form id="problemForm" method="GET" action="{% url 'reports:step3' %}">
        {% csrf_token %}

        <div class="topics-list">
            {% if topics %}
                <ul>
                    {% for topic in topics %}
                        <li class="topic-item-container">
                            <button type="button" class="topic-item"
                                    data-topic-id="{{ topic.pk }}"
                                    data-lat=""
                                    data-lon=""
                                    data-address=""
                                    data-title="{{ topic.title }}">
                                {{ topic.title }}
                            </button>
                            <button type="button" class="toggle-description">↓</button>
                            <div class="topic-description" style="display: none;">
                                <p>{{ topic.description }}</p>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>Темы пока не добавлены.</p>
            {% endif %}
        </div>

        <input type="hidden" id="latitude" name="latitude" placeholder="Широта" value="{{ request.session.lat }}" readonly required>
        <input type="hidden" id="longitude" name="longitude" placeholder="Долгота" value="{{ request.session.lon }}" readonly required>
    </form>
</div>


{% endif %}
{% endblock %}

{% block scripts %}
<script src="{% static 'js/step2.js' %}"></script>
{% endblock %}